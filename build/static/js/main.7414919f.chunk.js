(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(26),i=a.n(o),c=a(5),l=a(6),s=a(11),u=a(7),m=a(10),p=a(12),f=a(9),d=a(21),h=function(e){return e.children},g=a(19),v=a(24),E=a.n(v),b=function(e,t,a,n){return{type:"AUTH_SUCCESS",token:e,profile:t,email:a,userid:n}},y=function(e){return{type:"AUTH_FAIL",error:e}},k=function(){return localStorage.removeItem("token"),localStorage.removeItem("profile"),localStorage.removeItem("expirationDate"),{type:"AUTH_LOGOUT"}},N=function(e){return function(t){setTimeout(function(){t(k())},1e3*e)}},w=function(e){return function(t){E.a.get("http://127.0.0.1:8000/user/"+e).then(function(e){return e.data}).then(function(e){var a=JSON.parse(localStorage.getItem("topic")),n="";if(null!==e.profile){n=!0;var r=e.profile.topics.split(",").map(function(e){return a[e]});e.profile.topics=r}else n=!1;var o=localStorage.getItem("token");t(function(e,t,a){return{type:"PROFILE_CREATED",token:t,userdata:e,profile:a}}(e,o,n))})}},O=function(){return function(e){E.a.get("http://127.0.0.1:8000/user/topic").then(function(e){return e.data}).then(function(t){var a={};t.forEach(function(e){a[e.id]=e.name});var n=localStorage.getItem("token");localStorage.setItem("topic",JSON.stringify(a)),e(function(e,t){return{type:"TOPICS_FETCHED",token:e,topics:t}}(n,a))})}},S=function(){return function(e){var t=localStorage.getItem("token"),a=JSON.parse(localStorage.getItem("profile")),n=localStorage.getItem("email"),r=localStorage.getItem("userid");if(console.log(a),void 0===t)e(k());else{var o=new Date(localStorage.getItem("expirationDate"));o<=new Date?e(k()):(e(b(t,a,n,r)),e(N((o.getTime()-(new Date).getTime())/1e3)))}}},j=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:"",userid:""},a.handleChange=function(e){a.setState(Object(g.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault();var t=a.state,n=t.email,r=t.password;a.props.login(n,r)},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.error,a=e.token,n=e.profile,o=this.state,i=o.email,c=o.password;return console.log(n),a&&n?r.a.createElement(d.a,{to:"/user/"+this.props.userid}):a&&!n?r.a.createElement(d.a,{to:"/profile"}):r.a.createElement("section",{id:"cover"},r.a.createElement("div",{id:"cover-caption"},r.a.createElement("div",{id:"container",className:"container"},r.a.createElement("div",{className:"row text-white"},r.a.createElement("div",{id:"formdiv",className:"col-sm-8 col-md-6 offset-md-3 offset-sm-2 text-center",style:{padding:"4em"}},r.a.createElement("div",{className:"info-form"},r.a.createElement("h1",{className:"",style:{color:"#f56642"}},"Login"),t&&r.a.createElement("p",{style:{color:"black"}},"Incorrect email or password"),r.a.createElement("form",{id:"loginform",action:"",className:"form-inlin justify-content-center",onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"sr-only"},"Email"),r.a.createElement("input",{type:"email",name:"email",className:"form-control",placeholder:"Email",value:i,onChange:this.handleChange,required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"sr-only"},"Password"),r.a.createElement("input",{type:"password",name:"password",className:"form-control",placeholder:"Password",value:c,onChange:this.handleChange,required:!0,pattern:".{8,}"})),r.a.createElement("button",{type:"submit",id:"loginbtn",className:"btn"},"Login"))))))))}}]),t}(r.a.Component),C=Object(f.b)(function(e){return console.log(e.auth.profile),{error:e.auth.error,token:e.auth.token,profile:!1!==e.auth.profile&&null!==e.auth.profile,userid:e.auth.userid}},function(e){return{login:function(t,a){return e(function(e,t){return function(a){a({type:"AUTH_START"}),E.a.post("http://127.0.0.1:8000/rest-auth/login/",{email:e,password:t}).then(function(t){console.log(t.data.key),console.log(t.data.user.profile);var n=t.data.user.profile,r=t.data.user.id,o="";o=null!==n;var i=t.data.key,c=new Date((new Date).getTime()+36e5);localStorage.setItem("token",i),localStorage.setItem("profile",o),localStorage.setItem("email",e),localStorage.setItem("userid",r),localStorage.setItem("expirationDate",c),a(b(i,o,e,r)),a(N(3600))}).catch(function(e){a(y(e))})}}(t,a))},authCheckState:function(){return e(S())}}})(j),T=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password1:"",password2:""},a.handleSubmit=function(e){e.preventDefault();var t=a.state,n=t.email,r=t.password1,o=t.password2;a.props.signup(n,r,o)},a.handleChange=function(e){a.setState(Object(g.a)({},e.target.name,e.target.value))},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,a=e.password1,n=e.password2,o=this.props,i=o.error;return o.token?r.a.createElement(d.a,{to:"/profile"}):r.a.createElement("section",{id:"cover"},r.a.createElement("div",{id:"cover-caption"},r.a.createElement("div",{id:"container",className:"container"},r.a.createElement("div",{className:"row text-white"},r.a.createElement("div",{id:"formdiv",className:"col-sm-8 col-md-6 offset-md-3 offset-sm-2 text-center",style:{padding:"4em"}},r.a.createElement("div",{className:"info-form"},r.a.createElement("h1",{className:"",style:{color:"#f56642"}},"Create your credentials"),i&&r.a.createElement("p",{style:{color:"black"}},"Something went wrong, please try again"),r.a.createElement("form",{id:"loginform",action:"",className:"form-inlin justify-content-center",onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"sr-only"},"Email"),r.a.createElement("input",{type:"email",name:"email",className:"form-control",placeholder:"Email",value:t,onChange:this.handleChange,required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"sr-only"},"Password"),r.a.createElement("input",{type:"password",name:"password1",className:"form-control",placeholder:"Password",value:a,onChange:this.handleChange,required:!0,title:"minimum length 8"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"sr-only"},"Confirm Password"),r.a.createElement("input",{type:"password",name:"password2",className:"form-control",placeholder:"ConfirmPassword",value:n,onChange:this.handleChange,required:!0,pattern:".{8,}",title:"minimum length 8"})),r.a.createElement("button",{type:"submit",id:"loginbtn",className:"btn"},"Login"))))))))}}]),t}(r.a.Component),x=Object(f.b)(function(e){return{error:e.auth.error,token:e.auth.token}},function(e){return{signup:function(t,a,n,r){return e(function(e,t,a){return function(n){n({type:"AUTH_START"}),E.a.post("http://127.0.0.1:8000/rest-auth/registration/",{email:e,password1:t,password2:a}).then(function(t){console.log(t.data);var a=t.data.user.profile,r=t.data.key,o=new Date((new Date).getTime()+36e5),i=t.data.user.id,c="";c=!!a,localStorage.setItem("token",r),localStorage.setItem("expirationDate",o),localStorage.setItem("profile",c),localStorage.setItem("email",e),localStorage.setItem("userid",i),n(b(r,c,e,i)),n(N(3600))}).catch(function(e){n(y(e))})}}(t,a,n))}}})(T),I=(a(48),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){if("checkbox"===e.target.type&&e.target.checked)a.state.totalTopics<6?(a.state.totalTopics+=1,a.state.selectedTopics.push(e.target.value)):(e.preventDefault(),document.getElementById("error").innerHTML="You can only select 6 topics, remove a topic.");else if("checkbox"===e.target.type){a.state.totalTopics-=1;var t=a.state.selectedTopics.indexOf(e.target.value);a.state.selectedTopics.splice(t,1),document.getElementById("error").innerHTML=""}a.setState(Object(g.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault();var t={};t.email=a.props.email,t.first_name=a.state.first_name,t.last_name=a.state.last_name,t.profile={},t.profile.currentPosition=a.state.position,t.profile.bio=a.state.bio,t.profile.topics=a.state.selectedTopics.join(","),a.props.createProfile(a.props.userid,JSON.stringify(t))},a.state={authenticated:"",profile:"",topics:["Topic 1","Topic 2"],position:"",first_name:"",last_name:"",bio:"",userid:"",totalTopics:0,selectedTopics:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("http://127.0.0.1:8000/user/topic").then(function(e){return e.json()}).then(function(t){var a=Object.keys(t).map(function(e){return[t[e].id,t[e].name]});e.setState({topics:a})})}},{key:"render",value:function(){var e=this,t=this.props,a=t.authenticated;t.profile;return!0===this.props.profile&&a?r.a.createElement(d.a,{to:"/user/"+this.props.userid}):this.props.profile||a?r.a.createElement("section",{id:"cover"},r.a.createElement("div",{id:"cover-caption"},r.a.createElement("div",{id:"container",className:"container"},r.a.createElement("div",{className:"row text-white"},r.a.createElement("div",{id:"formdiv",className:"col-sm-6 offset-sm-3 col-md-8 offset-md-2 text-center",style:{padding:"4em"}},r.a.createElement("div",{className:"info-form"},r.a.createElement("h1",{className:"",style:{color:"#f56642"}},"Create your profile"),r.a.createElement("br",null),r.a.createElement("form",{action:"",className:"form-inlin justify-content-center",onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"form-group col-md-6"},r.a.createElement("input",{type:"text",className:"form-control",id:"first_name",name:"first_name",placeholder:"First Name",onChange:this.handleChange,required:!0})),r.a.createElement("div",{className:"form-group col-md-6"},r.a.createElement("input",{type:"text",className:"form-control",id:"last_name",name:"last_name",placeholder:"Last Name",onChange:this.handleChange,required:!0}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Current Position",onChange:this.handleChange,name:"position",required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("textarea",{type:"textarea",name:"bio",className:"form-control",placeholder:"About you",rows:"4",maxLength:"256",onChange:this.handleChange,required:!0})),r.a.createElement("h4",{style:{textAlign:"left",fontWeight:"400",color:"black"}},"Select your favorite topics:"),r.a.createElement("p",{id:"error"}),r.a.createElement("div",{className:"form-row"},this.state.topics.map(function(t,a){return r.a.createElement(r.a.Fragment,{key:t},r.a.createElement("div",{className:"form-group col-sm-6"},r.a.createElement("div",{className:"form-check checkbox"},r.a.createElement("input",{key:t,type:"checkbox",value:t[0],className:"form-check-input",id:"exampleCheck1",style:{marginLeft:"0.5em"},onClick:e.handleChange,name:t[1]}),r.a.createElement("label",{key:t[0],style:{marginBottom:"0",marginLeft:"2em"},className:"checkbox-inline",htmlFor:"defaultCheck2"},t[1]))))})),r.a.createElement("button",{type:"submit",id:"loginbtn",className:"btn"},"Save")))))))):r.a.createElement(d.a,{to:"/"})}}]),t}(r.a.Component)),_=Object(f.b)(function(e){return console.log(null!==e.auth.profile&&!1!==e.auth.profile),{authenticated:null!==e.auth.token,profile:null!==e.auth.profile&&!1!==e.auth.profile,email:e.auth.email,topics:e.auth.topics,userid:e.auth.userid}},function(e){return{fetchAllTopics:function(){return e(O())},authCheckState:function(){return e(S())},createProfile:function(t,a){return e(function(e,t){return function(a){console.log(t),E.a.put("http://127.0.0.1:8000/user/"+e,JSON.parse(t)).then(function(e){return e.data}).then(function(t){a(w(e))})}}(t,a))},logout:function(){return e(k())}}})(I),A=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchAllUsers(),this.props.fetchAllTopics()}},{key:"render",value:function(){return r.a.createElement("section",{id:"cover"},r.a.createElement("div",{id:"cover-caption"},r.a.createElement("div",{id:"container",className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{id:"",className:"formdiv col-sm-6 offset-sm-3 col-md-8 offset-md-2 text-center",style:{padding:"4em"}})))))}}]),t}(n.Component),D=Object(f.b)(function(e){return{users:e.auth.users}},function(e){return{fetchAllUsers:function(){return e(function(e){E.a.get("http://127.0.0.1:8000/user/").then(function(e){return e.data}).then(function(t){var a=t,n=JSON.parse(localStorage.getItem("topic")),r=[];a.forEach(function(e){var t=e.first_name+" "+e.last_name;r.push({name:t,topics:e.profile.topics.split(",").map(function(e){return n[e]}).sort()})}),e(function(e){return{type:"USER_LIST",users:e}}(a))})})},authCheckState:function(){return e(S())},logout:function(){return e(k())},fetchAllTopics:function(){return e(O())}}})(A),U=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"Welcome")}}]),t}(n.Component),L=a(54),P=a.n(L),H=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.authCheckState();var e=this.props.match.params.handle;this.props.fetchTopics(),this.props.fetchUserData(e)}},{key:"render",value:function(){var e=this.props,t=e.authenticated,a=e.profile;e.userdata;return!a&&t?r.a.createElement(d.a,{to:"/profile"}):a&&t?r.a.createElement("section",{id:"cover"},r.a.createElement("div",{id:"cover-caption"},r.a.createElement("div",{id:"container",className:"container p-0"},r.a.createElement("div",{className:"row text-white"},r.a.createElement("div",{id:"formdiv",className:"col-sm-6 offset-sm-3 col-md-6 offset-md-3 text-center",style:{padding:"4em"}},r.a.createElement("img",{src:P.a,className:"mx-auto d-block avatar",alt:""}),r.a.createElement("div",{className:"container p-0 m-0"},r.a.createElement("div",{className:"container p-0 m-0"},null!=this.props.userdata&&r.a.createElement("h2",{id:"fullname",className:"text-capitalize"},this.props.userdata.first_name+" "+this.props.userdata.last_name),null!=this.props.userdata&&r.a.createElement("p",{className:"text-center"},this.props.userdata.profile.currentPosition),r.a.createElement("div",{className:"col-md-12 text-center"}),r.a.createElement("hr",{className:"underline"}),r.a.createElement("div",{className:"row font-weight-light"},null!=this.props.userdata&&r.a.createElement("p",{className:"text-center"},this.props.userdata.profile.bio)),r.a.createElement("div",{className:"container mt-3 p-0"},r.a.createElement("div",{className:"row col-md-12 m-0 p-0 justify-content-center"},null!=this.props.userdata&&this.props.userdata.profile.topics.map(function(e){return r.a.createElement("div",{key:e,className:"col-md-5 mr-4 mt-4 p-3 border"},e)})))))))))):r.a.createElement(d.a,{to:"/"})}}]),t}(r.a.Component),R=Object(f.b)(function(e){return{authenticated:null!==e.auth.token,profile:null!==e.auth.profile,userdata:e.auth.userdata}},function(e){return{logout:function(){return e(k())},fetchTopics:function(){return e(O())},fetchUserData:function(t){return e(w(t))},authCheckState:function(){return e(S())}}})(H),F=function(){return r.a.createElement(h,null,r.a.createElement(d.b,{path:"/login",component:C}),r.a.createElement(d.b,{path:"/signup",component:x}),r.a.createElement(d.b,{path:"/profile",component:_}),r.a.createElement(d.b,{path:"/users",component:D}),r.a.createElement(d.b,{path:"/user/:handle",render:function(e){return r.a.createElement(R,e)}}),r.a.createElement(d.b,{exact:!0,path:"/",component:U}))},q=(a(89),a(105)),J=a(106),W=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.authCheckState()}},{key:"render",value:function(){var e=this,t=this.props,a=t.authenticated,n=t.profile;return a&&!n?r.a.createElement(d.a,{to:"/profile"}):r.a.createElement("div",null,r.a.createElement(q.a,{bg:"dark",variant:"dark","data-spy":"affix"},r.a.createElement(p.b,{to:"/",className:"navbar-brand"},"Udemy Coding Challenge"),r.a.createElement(J.a,{className:"mr-auto"},a?r.a.createElement(r.a.Fragment,null,r.a.createElement(p.b,{className:"nav-link",to:"/profile"},"Profile"),r.a.createElement(J.a.Link,{className:"nav-link",onClick:function(){return e.props.logout()}},"Logout")):r.a.createElement(r.a.Fragment,null,r.a.createElement(p.b,{to:"/login",className:"nav-link"},"Login"),r.a.createElement(p.b,{to:"/signup",className:"nav-link"},"Signup"),r.a.createElement(p.b,{to:"/users",className:"nav-link"},"Users")))),this.props.children)}}]),t}(r.a.Component),M=Object(d.f)(Object(f.b)(function(e){return{authenticated:null!==e.auth.token,profile:null!==e.auth.profile||!0===e.auth.profile}},function(e){return{authCheckState:function(){return e(S())},logout:function(){return e(k())}}})(W)),B=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.authCheckState()}},{key:"render",value:function(){return r.a.createElement(p.a,null,r.a.createElement(M,this.props,r.a.createElement(F,null)))}}]),t}(n.Component),G=Object(f.b)(function(e){return{isAuthenticated:null!==e.auth.token}},function(e){return{authCheckState:function(){return e(S())}}})(B),X=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function z(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var V=a(23),Y=a(59),$=a(60),K=function(e,t){return Object($.a)({},e,t)},Q={token:null,error:null,loading:!1,profile:null,topics:["Topic 1","Topic 2"],position:"",fname:"",lname:"",bio:"",email:""},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_START":return function(e,t){return K(e,{error:null,loading:!0})}(e);case"AUTH_SUCCESS":return function(e,t){return K(e,{token:t.token,error:null,loading:!1,profile:t.profile,email:t.email,userid:t.userid})}(e,t);case"AUTH_FAIL":return function(e,t){return K(e,{error:t.error,loading:!1})}(e,t);case"AUTH_LOGOUT":return function(e,t){return K(e,{token:null,profile:null})}(e);case"PROFILE_CREATED":return function(e,t){return K(e,{token:t.token,userdata:t.userdata,profile:JSON.parse(t.profile)})}(e,t);case"TOPICS_FETCHED":return function(e,t){return K(e,{token:t.token,topics:t.topics})}(e,t);case"USER_LIST":return function(e,t){return K(e,{users:t.users})}(e,t);default:return e}},ee=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||V.d,te=Object(V.c)({auth:Z}),ae=Object(V.e)(te,ee(Object(V.a)(Y.a))),ne=r.a.createElement(f.a,{store:ae},r.a.createElement(G,null));i.a.render(ne,document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");X?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):z(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):z(t,e)})}}()},48:function(e,t,a){},54:function(e,t,a){e.exports=a.p+"static/media/default-avatar.5097b024.png"},62:function(e,t,a){e.exports=a(102)}},[[62,1,2]]]);
//# sourceMappingURL=main.7414919f.chunk.js.map